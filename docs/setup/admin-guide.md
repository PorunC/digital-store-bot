# ç®¡ç†å‘˜æŒ‡å—

æœ¬æŒ‡å—é¢å‘ç³»ç»Ÿç®¡ç†å‘˜ï¼Œä»‹ç»å¦‚ä½•ç®¡ç†å’Œç»´æŠ¤ Digital Store Bot v2ã€‚

## ğŸ”‘ ç®¡ç†å‘˜æƒé™

### è·å–ç®¡ç†å‘˜æƒé™

1. åœ¨ `config/settings.yml` ä¸­é…ç½®æ‚¨çš„ Telegram IDï¼š

```yaml
bot:
  admin_ids: 
    - 123456789  # æ‚¨çš„ Telegram ç”¨æˆ· ID
    - 987654321  # å…¶ä»–ç®¡ç†å‘˜ ID
```

2. é‡å¯æœºå™¨äººä½¿é…ç½®ç”Ÿæ•ˆ

### ç®¡ç†å‘˜å‘½ä»¤

ç®¡ç†å‘˜åœ¨ Telegram ä¸­å¯ä½¿ç”¨ç‰¹æ®Šå‘½ä»¤ï¼š

- `/admin` - è¿›å…¥ç®¡ç†å‘˜æ¨¡å¼
- `/stats` - æŸ¥çœ‹ç³»ç»Ÿç»Ÿè®¡
- `/users` - ç”¨æˆ·ç®¡ç†
- `/orders` - è®¢å•ç®¡ç†
- `/products` - äº§å“ç®¡ç†

## ğŸ–¥ï¸ Web ç®¡ç†é¢æ¿

### è®¿é—®ç®¡ç†é¢æ¿

1. å¯åŠ¨ Web ç®¡ç†æœåŠ¡ï¼š

```bash
# å¼€å‘ç¯å¢ƒ
poetry run python src/presentation/web/admin_main.py

# ç”Ÿäº§ç¯å¢ƒ (Docker)
docker compose up admin -d
```

2. è®¿é—® `http://localhost:8080/admin`

### é¢æ¿åŠŸèƒ½

- **ğŸ“Š æ•°æ®ä»ªè¡¨æ¿** - å®æ—¶ç»Ÿè®¡å’Œå›¾è¡¨
- **ğŸ‘¥ ç”¨æˆ·ç®¡ç†** - ç”¨æˆ·ä¿¡æ¯å’Œæƒé™ç®¡ç†
- **ğŸ“¦ äº§å“ç®¡ç†** - äº§å“ä¸Šæ¶ã€ç¼–è¾‘ã€ä¸‹æ¶
- **ğŸ’° è®¢å•ç®¡ç†** - è®¢å•çŠ¶æ€å’Œé€€æ¬¾å¤„ç†
- **ğŸ’³ æ”¯ä»˜ç®¡ç†** - æ”¯ä»˜ç½‘å…³å’Œäº¤æ˜“è®°å½•
- **ğŸ”— æ¨èç®¡ç†** - æ¨èå…³ç³»å’Œä½£é‡‘ç®¡ç†

## ğŸ‘¥ ç”¨æˆ·ç®¡ç†

### æŸ¥çœ‹ç”¨æˆ·ä¿¡æ¯

é€šè¿‡ Web é¢æ¿æˆ– Telegram å‘½ä»¤ï¼š

```
/users list - æ˜¾ç¤ºç”¨æˆ·åˆ—è¡¨
/users info <user_id> - æŸ¥çœ‹ç‰¹å®šç”¨æˆ·è¯¦æƒ…
/users search <keyword> - æœç´¢ç”¨æˆ·
```

### ç”¨æˆ·æ“ä½œ

- **ç¦ç”¨ç”¨æˆ·**: æš‚åœç”¨æˆ·è®¿é—®æƒé™
- **é‡ç½®å¯†ç **: é‡ç½®ç”¨æˆ·è´¦æˆ·
- **ä½™é¢è°ƒæ•´**: æ‰‹åŠ¨è°ƒæ•´ç”¨æˆ·ä½™é¢
- **è®¢å•å†å²**: æŸ¥çœ‹ç”¨æˆ·è´­ä¹°è®°å½•

### æ‰¹é‡æ“ä½œ

- å¯¼å‡ºç”¨æˆ·æ•°æ®
- æ‰¹é‡å‘é€é€šçŸ¥
- ç”¨æˆ·æ•°æ®ç»Ÿè®¡åˆ†æ

## ğŸ“¦ äº§å“ç®¡ç†

### äº§å“é…ç½®æ–‡ä»¶

äº§å“ä¿¡æ¯å­˜å‚¨åœ¨ `data/products.json`ï¼š

```json
{
  "categories": [
    {
      "id": "software",
      "name": "è½¯ä»¶è®¸å¯",
      "description": "å„ç±»è½¯ä»¶å’Œå·¥å…·",
      "emoji": "ğŸ’»"
    }
  ],
  "products": [
    {
      "id": "premium_1month",
      "name": "é«˜çº§ä¼šå‘˜ - 1ä¸ªæœˆ",
      "description": "äº«å—æ‰€æœ‰é«˜çº§åŠŸèƒ½",
      "category_id": "software",
      "price": 9.99,
      "currency": "USD",
      "duration_days": 30,
      "is_active": true,
      "stock": 1000
    }
  ]
}
```

### äº§å“æ“ä½œ

- **æ·»åŠ äº§å“**: åœ¨ `data/products.json` æ–‡ä»¶ä¸­æ·»åŠ æ–°äº§å“
- **ç¼–è¾‘äº§å“**: ä¿®æ”¹ä»·æ ¼ã€æè¿°ç­‰ä¿¡æ¯
- **åº“å­˜ç®¡ç†**: è°ƒæ•´äº§å“åº“å­˜æ•°é‡
- **ä¸Šæ¶/ä¸‹æ¶**: æ§åˆ¶äº§å“æ˜¾ç¤ºçŠ¶æ€

### äº§å“æ•°æ®åŠ è½½

ç³»ç»Ÿå¯åŠ¨æ—¶ä¼šè‡ªåŠ¨ä» `data/products.json` åŠ è½½äº§å“æ•°æ®ã€‚ç®¡ç†å‘˜å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼é‡æ–°åŠ è½½ï¼š

#### é€šè¿‡ Telegram ç®¡ç†é¢æ¿

1. å‘é€ `/admin` å‘½ä»¤è¿›å…¥ç®¡ç†é¢æ¿
2. ç‚¹å‡» **ğŸ“¦ Products** 
3. ç‚¹å‡» **ğŸ”„ Reload from JSON**
4. ç³»ç»Ÿä¼šä» JSON æ–‡ä»¶é‡æ–°åŠ è½½æ‰€æœ‰äº§å“

#### é€šè¿‡ Web ç®¡ç†é¢æ¿

```bash
# é‡æ–°åŠ è½½äº§å“é…ç½® (å¦‚æœWebé¢æ¿å¯ç”¨)
curl -X POST http://localhost:8080/admin/reload-products
```

#### äº§å“ JSON æ ¼å¼

äº§å“é…ç½®æ–‡ä»¶ä½äº `data/products.json`ï¼Œç¤ºä¾‹ç»“æ„ï¼š

```json
{
  "categories": [
    {
      "id": "software",
      "name": "Software Licenses",
      "description": "Premium software licenses",
      "emoji": "ğŸ’»"
    }
  ],
  "products": [
    {
      "id": "premium_1month",
      "name": "Premium Access - 1 Month",
      "description": "One month premium access",
      "category_id": "software",
      "price": 9.99,
      "currency": "USD",
      "duration_days": 30,
      "is_active": true,
      "stock": 1000,
      "delivery_type": "automatic",
      "metadata": {
        "features": ["Feature 1", "Feature 2"],
        "delivery_template": "Thank you for your purchase!"
      }
    }
  ]
}
```

## ğŸ’° è®¢å•ç®¡ç†

### è®¢å•çŠ¶æ€

- **å¾…æ”¯ä»˜** (pending) - è®¢å•å·²åˆ›å»ºï¼Œç­‰å¾…æ”¯ä»˜
- **å·²æ”¯ä»˜** (paid) - æ”¯ä»˜æˆåŠŸï¼Œç­‰å¾…å‘è´§
- **å·²å®Œæˆ** (completed) - è®¢å•å·²å‘è´§å®Œæˆ
- **å·²å–æ¶ˆ** (cancelled) - è®¢å•å·²å–æ¶ˆ
- **å·²é€€æ¬¾** (refunded) - è®¢å•å·²é€€æ¬¾

### è®¢å•å¤„ç†

```bash
# æŸ¥çœ‹è®¢å•åˆ—è¡¨
/orders list

# è®¢å•è¯¦æƒ…
/orders info <order_id>

# æ‰‹åŠ¨å®Œæˆè®¢å•
/orders complete <order_id>

# é€€æ¬¾å¤„ç†
/orders refund <order_id>
```

### æ‰¹é‡å¤„ç†

- å¯¼å‡ºè®¢å•æ•°æ®
- æ‰¹é‡çŠ¶æ€æ›´æ–°
- è´¢åŠ¡å¯¹è´¦æŠ¥å‘Š

## ğŸ’³ æ”¯ä»˜ç®¡ç†

### æ”¯ä»˜ç½‘å…³é…ç½®

#### Cryptomus é…ç½®

```yaml
payments:
  cryptomus:
    enabled: true
    merchant_id: "your_merchant_id"
    api_key: "your_api_key"
    webhook_secret: "your_webhook_secret"
```

#### Telegram Stars é…ç½®

```yaml
payments:
  telegram_stars:
    enabled: true
    provider_token: "your_provider_token"
```

### æ”¯ä»˜ç›‘æ§

- å®æ—¶æ”¯ä»˜çŠ¶æ€ç›‘æ§
- å¤±è´¥æ”¯ä»˜åˆ†æ
- æ”¯ä»˜ç½‘å…³æ€§èƒ½ç»Ÿè®¡
- è´¢åŠ¡æŠ¥è¡¨ç”Ÿæˆ

## ğŸ”— æ¨èç³»ç»Ÿç®¡ç†

### æ¨èè®¾ç½®

```yaml
referral:
  enabled: true
  level_one_reward_rate: 0.10  # ä¸€çº§æ¨è 10%
  level_two_reward_rate: 0.05  # äºŒçº§æ¨è 5%
  bonus_devices_count: 1       # å¥–åŠ±è®¾å¤‡æ•°é‡
```

### æ¨èæ•°æ®

- æ¨èå…³ç³»é“¾æŸ¥çœ‹
- ä½£é‡‘è®¡ç®—å’Œå‘æ”¾
- æ¨èæ•ˆæœåˆ†æ
- åä½œå¼Šæ£€æµ‹

## ğŸ“Š ç›‘æ§å’Œç»Ÿè®¡

### ç³»ç»Ÿç›‘æ§

```bash
# æ£€æŸ¥ç³»ç»Ÿå¥åº·çŠ¶æ€
./scripts/healthcheck.sh

# è¯¦ç»†æœåŠ¡çŠ¶æ€
python3 scripts/check_services.py

# æŸ¥çœ‹ç³»ç»Ÿæ—¥å¿—
tail -f logs/app.log
```

### å…³é”®æŒ‡æ ‡

- **ç”¨æˆ·æŒ‡æ ‡**: æ³¨å†Œæ•°ã€æ´»è·ƒç”¨æˆ·ã€ç•™å­˜ç‡
- **ä¸šåŠ¡æŒ‡æ ‡**: è®¢å•é‡ã€æ”¶å…¥ã€è½¬åŒ–ç‡
- **æŠ€æœ¯æŒ‡æ ‡**: å“åº”æ—¶é—´ã€é”™è¯¯ç‡ã€å¯ç”¨æ€§

### æŠ¥è­¦è®¾ç½®

é…ç½®ç›‘æ§æŠ¥è­¦ï¼š

- ç³»ç»Ÿæ•…éšœè‡ªåŠ¨é€šçŸ¥
- ä¸šåŠ¡å¼‚å¸¸æŒ‡æ ‡æŠ¥è­¦
- æ”¯ä»˜å¤±è´¥ç‡è¶…é˜ˆå€¼

## ğŸ—„ï¸ æ•°æ®åº“ç®¡ç†

### æ•°æ®åº“è¿ç§»

```bash
# åˆ›å»ºæ–°è¿ç§»
poetry run python -m src.infrastructure.database.migrations.migration_manager create "è¿ç§»æè¿°"

# åº”ç”¨è¿ç§»
poetry run python -m src.infrastructure.database.migrations.migration_manager upgrade

# å›æ»šè¿ç§»
poetry run python -m src.infrastructure.database.migrations.migration_manager downgrade
```

### æ•°æ®å¤‡ä»½

```bash
# æ‰‹åŠ¨å¤‡ä»½
./scripts/backup-database.sh

# è‡ªåŠ¨å¤‡ä»½ (cron job)
0 2 * * * /path/to/scripts/backup-database.sh
```

### æ•°æ®æ¢å¤

```bash
# ä»å¤‡ä»½æ¢å¤
./scripts/restore-database.sh backup_file.sql
```

## ğŸ”’ å®‰å…¨ç®¡ç†

### è®¿é—®æ§åˆ¶

- å®šæœŸæ›´æ–°ç®¡ç†å‘˜åˆ—è¡¨
- ç›‘æ§å¼‚å¸¸ç®¡ç†æ“ä½œ
- å®æ–½æœ€å°æƒé™åŸåˆ™

### æ•°æ®ä¿æŠ¤

- æ•æ„Ÿæ•°æ®åŠ å¯†å­˜å‚¨
- å®šæœŸå®‰å…¨å®¡è®¡
- åˆè§„æ€§æ£€æŸ¥

### æ—¥å¿—å®¡è®¡

- æ‰€æœ‰ç®¡ç†æ“ä½œè®°å½•æ—¥å¿—
- å¼‚å¸¸è®¿é—®æ£€æµ‹
- å®‰å…¨äº‹ä»¶å“åº”

## ğŸš¨ æ•…éšœå¤„ç†

### å¸¸è§é—®é¢˜

#### æœºå™¨äººæ— å“åº”
1. æ£€æŸ¥æœåŠ¡è¿›ç¨‹çŠ¶æ€
2. éªŒè¯ Bot Token æœ‰æ•ˆæ€§
3. æ£€æŸ¥ç½‘ç»œè¿æ¥

#### æ”¯ä»˜å¤±è´¥
1. æ£€æŸ¥æ”¯ä»˜ç½‘å…³é…ç½®
2. éªŒè¯ Webhook å›è°ƒ
3. æŸ¥çœ‹æ”¯ä»˜æ—¥å¿—

#### æ•°æ®åº“é”™è¯¯
1. æ£€æŸ¥æ•°æ®åº“è¿æ¥
2. éªŒè¯è¿ç§»çŠ¶æ€
3. æ£€æŸ¥ç£ç›˜ç©ºé—´

### åº”æ€¥å¤„ç†

```bash
# å¿«é€Ÿé‡å¯æœåŠ¡
docker compose restart bot

# ç´§æ€¥ç»´æŠ¤æ¨¡å¼
echo "maintenance" > /tmp/maintenance.flag

# æ¢å¤æ­£å¸¸æœåŠ¡
rm /tmp/maintenance.flag
```

## ğŸ“‹ ç»´æŠ¤æ¸…å•

### æ—¥å¸¸ç»´æŠ¤

- [ ] æ£€æŸ¥ç³»ç»Ÿæ—¥å¿—
- [ ] ç›‘æ§å…³é”®æŒ‡æ ‡
- [ ] éªŒè¯å¤‡ä»½çŠ¶æ€
- [ ] æ›´æ–°å®‰å…¨è¡¥ä¸

### å‘¨æœŸç»´æŠ¤

- [ ] æ•°æ®åº“æ€§èƒ½ä¼˜åŒ–
- [ ] æ¸…ç†è¿‡æœŸæ•°æ®
- [ ] æ›´æ–°ä¾èµ–åŒ…
- [ ] å®‰å…¨å®¡è®¡

### ç‰ˆæœ¬æ›´æ–°

- [ ] å¤‡ä»½å½“å‰ç‰ˆæœ¬
- [ ] æµ‹è¯•æ–°ç‰ˆæœ¬
- [ ] ç°åº¦å‘å¸ƒ
- [ ] å…¨é‡éƒ¨ç½²

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚éœ€æŠ€æœ¯æ”¯æŒï¼š

- ğŸ“§ æŠ€æœ¯é‚®ç®±: tech@digitalstore.com
- ğŸ”§ ç´§æ€¥è”ç³»: +1-xxx-xxx-xxxx
- ğŸ“– æŠ€æœ¯æ–‡æ¡£: [å¼€å‘æŒ‡å—](../development/CLAUDE.md)

---

ğŸ›¡ï¸ ç³»ç»Ÿå®‰å…¨å’Œç¨³å®šè¿è¡Œæ˜¯æˆ‘ä»¬çš„é¦–è¦ä»»åŠ¡ï¼Œå¦‚æœ‰ä»»ä½•ç–‘é—®è¯·åŠæ—¶è”ç³»æŠ€æœ¯å›¢é˜Ÿã€‚